<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在實驗室自架 VMware ESXi — 使用電腦教室汰換之電腦 | Oscar&#39;s Pathways</title>
    <meta name="description" content="自從離開前一間實習的公司，我就缺乏一個可以做 Lab 的地方，深刻感受到「伺服器戒斷症」。想當初公司是天天有 Server 可以使用，有 Cisco UCS、Hyperflex 和 Supermicro 的等等，離開後變成只能偶爾用 AWS Educate 帳號開個限制滿滿的 EC2。這次學校電腦教室有汰換下來的幾台電腦，聽說當初買一台要價 10 萬元，不過也是好幾年前了。規格不會太差，因此開始動起歪腦筋，抱了一台到座位旁開始研究。">
    <link rel="icon" href="/logo.png">
  <meta name="theme-color" content="#333333">
  <meta prefix="og: http://ogp.me/ns#" property="og:title" content="Oscar&#39;s Pathways">
  <meta prefix="og: http://ogp.me/ns#" property="og:type" content="article">
  <meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://lytzeng.github.io">
  <meta prefix="og: http://ogp.me/ns#" property="og:image" content="/logo.png">
  <meta prefix="og: http://ogp.me/ns#" property="og:article:author" content="Li-Yen Tseng">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/logo.png">
  <link rel="mask-icon" href="/logo.svg" color="#333333">
  <meta name="msapplication-TileColor" content="#333333">
    
    <link rel="preload" href="/assets/css/0.styles.e2fb14d1.css" as="style"><link rel="preload" href="/assets/js/app.76b48eb5.js" as="script"><link rel="preload" href="/assets/js/3.56656fbc.js" as="script"><link rel="preload" href="/assets/js/2.c4dd9767.js" as="script"><link rel="preload" href="/assets/js/4.bb04b1e8.js" as="script"><link rel="preload" href="/assets/js/13.808138b6.js" as="script"><link rel="prefetch" href="/assets/js/10.74fa9c95.js"><link rel="prefetch" href="/assets/js/11.4a6ce6b5.js"><link rel="prefetch" href="/assets/js/12.287dad4c.js"><link rel="prefetch" href="/assets/js/14.77944e74.js"><link rel="prefetch" href="/assets/js/15.dbc80105.js"><link rel="prefetch" href="/assets/js/16.2a3c5e9c.js"><link rel="prefetch" href="/assets/js/17.cef0d600.js"><link rel="prefetch" href="/assets/js/18.11e9f5c0.js"><link rel="prefetch" href="/assets/js/19.87e3df21.js"><link rel="prefetch" href="/assets/js/5.bf60b092.js"><link rel="prefetch" href="/assets/js/6.4e96e2c5.js"><link rel="prefetch" href="/assets/js/7.26f0178e.js"><link rel="prefetch" href="/assets/js/8.43a50169.js"><link rel="prefetch" href="/assets/js/9.775ca00a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e2fb14d1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Oscar's Pathways" class="logo"> <span class="site-name can-hide">Oscar's Pathways</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/categories/" class="nav-link">Categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div class="bio bio-sidebar"><div class="img-holder"><img src="https://avatars3.githubusercontent.com/u/30722178?s=460&v=4"></div> <p class="name">Oscar Tseng</p> <div style="border-bottom: 1px solid hsl(0, 0%, 30%); border-top: 1px solid hsl(0, 0%, 30%);"><div style="display: inline-block; padding: 0 10px; border-right: 1px solid hsl(0, 0%, 30%); margin: 5px 0"><a href="/categories/"><span style="display:block;font-family:'Noto Sans TC Medium';font-size:20px;">5</span> <span>Posts</span></a></div> <div style="display: inline-block; padding: 0 10px; margin: 5px 0"><a href="/tags/"><span style="display:block;font-family:'Noto Sans TC Medium';font-size:20px;">4</span> <span>Tags</span></a></div></div> <div style="display: flex; justify-content: center; padding-top: 5px; padding-bottom: 5px; border-bottom: 1px solid hsl(0, 0%, 30%);"><span style="width: 32px; height: 32px;"><a href="https://github.com/LYTzeng" target="_blank" rel="noopener" title="Github"><svg fill="#e6e6e6" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" style="will-change: transform;"><path fill-rule="evenodd" d="M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45 3 3 0 0 0 4.08 1.16 2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76 5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7 5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z"></path></svg></a></span> <span style="width: 32px; height: 32px;"><a href="https://www.linkedin.com/in/li-yen-tseng/" target="_blank" rel="noopener" title="Linkedin"><svg fill="#e6e6e6" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" style="will-change: transform;"><path d="M26.21 4H5.79A1.78 1.78 0 0 0 4 5.73V26.2a1.77 1.77 0 0 0 1.79 1.73h20.42A1.77 1.77 0 0 0 28 26.2V5.73A1.78 1.78 0 0 0 26.21 4zm-15.1 20.41H7.59V13h3.52zm-1.72-13a2.07 2.07 0 0 1-2.07-2.02 2 2 0 0 1 2.07-2.07 2.07 2.07 0 0 1 0 4.13zm15.09 12.93H21v-5.58c0-1.33 0-3.06-1.86-3.06S17 17.16 17 18.63v5.65h-3.56V13h3.32v1.5h.07a3.72 3.72 0 0 1 3.39-1.86c3.59 0 4.26 2.4 4.26 5.45z"></path></svg></a></span> <span style="width: 32px; height: 32px;"><a href="mailto:oscar217b@gmail.com" target="_blank" rel="noopener" title="mail"><svg fill="#e6e6e6" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" style="will-change: transform;"><path d="M28 6H4a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm-2.2 2L16 14.78 6.2 8zM4 24V8.91l11.43 7.91a1 1 0 0 0 1.14 0L28 8.91V24z"></path><title>Email</title></svg></a></span> <span style="width: 32px; height: 32px;"><a href="/feed.xml" target="_blank" rel="noopener" title="rss" type="application/rss+xml"><svg fill="#e6e6e6" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" style="will-change: transform;"><path d="M8 18c-3.3 0-6 2.7-6 6s2.7 6 6 6 6-2.7 6-6-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm22-4h-2C28 13 19 4 8 4V2c12.1 0 22 9.9 22 22z"></path><path d="M22 24h-2c0-6.6-5.4-12-12-12v-2c7.7 0 14 6.3 14 14z"></path><title>Rss</title></svg></a></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/categories/" class="nav-link">Categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>在實驗室自架 VMware ESXi — 使用電腦教室汰換之電腦</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#規格" class="sidebar-link">規格</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#前置作業" class="sidebar-link">前置作業</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#踩雷" class="sidebar-link">踩雷</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#救星：gparted" class="sidebar-link">救星：GParted</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#處理mbr" class="sidebar-link">處理MBR</a></li><li class="sidebar-sub-header"><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#切磁區" class="sidebar-link">切磁區</a></li><li class="sidebar-sub-header"><a href="/posts/infra/self-hosted-esxi-server-in-lab.html#格式化" class="sidebar-link">格式化</a></li></ul></li></ul></section></li></ul> <div class="sidebar-links"><p class="sidebar-heading"><span>近期文章</span></p> <ul><li><a href="/posts/infra/self-hosted-esxi-server-in-lab.html" class="sidebar-link recentTitle">在實驗室自架 VMware ESXi — 使用電腦教室汰換之電腦</a></li><li><a href="/posts/frontend/Vue/vuepress-blog-3.html" class="sidebar-link recentTitle">VuePress 部落格架設與折騰 (三)：Global Computed、標籤與分類功能、Components 的應用</a></li><li><a href="/posts/frontend/Vue/vuepress-blog-2.html" class="sidebar-link recentTitle">VuePress 部落格架設與折騰 (二)：Components</a></li><li><a href="/posts/frontend/Vue/vuepress-blog-1.html" class="sidebar-link recentTitle">VuePress 部落格架設與折騰 (一)：Themes、頁面元素、部署至 Github</a></li><li><a href="/posts/misc/Why-I-launch-this-blog.html" class="sidebar-link recentTitle">開端</a></li></ul></div> <div class="sidebar-links"><p class="sidebar-heading"><span>Tags</span></p> <div class="tags sidebar-tags sidebar-link"><span><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1><a href="/tags/VuePress"><div>VuePress
        <div class="tagcount">3</div></div></a></span></span><span><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1><a href="/tags/VMware"><div>VMware
        <div class="tagcount">1</div></div></a></span></span><span><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1><a href="/tags/vSphere"><div>vSphere
        <div class="tagcount">1</div></div></a></span></span><span><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1><a href="/tags/心得想法"><div>心得想法
        <div class="tagcount">1</div></div></a></span></span></div></div> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="在實驗室自架-vmware-esxi-—-使用電腦教室汰換之電腦"><a href="#在實驗室自架-vmware-esxi-—-使用電腦教室汰換之電腦" class="header-anchor">#</a> 在實驗室自架 VMware ESXi — 使用電腦教室汰換之電腦</h1> <div class="page-edit"><div class="last-updated"><span class="prefix"><svg fill="#ececec" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true" style="display: inline-block; vertical-align: middle; will-change: transform;"><path d="M26 4.03h-4v-2h-2v2h-8v-2h-2v2H6a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h20a2 2 0 0 0 2-2v-20a2 2 0 0 0-2-2zm0 22H6v-14h20zm0-16H6v-4h4v2h2v-2h8v2h2v-2h4z"></path><title>Calendar</title></svg></span> <span class="time">12/13/2019, 10:44:38 PM</span></div></div> <div><div class="taglinks"><a href="/categories/#Infra"><div style="display:inline;"><svg fill="#14cdef" focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true" style="display:inline-block;vertical-align:middle;will-change:transform;"><path d="M11.17 6l3.42 3.41.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z"></path><title>Folder</title></svg></div>
  Infra</a> <a href="/tags/VMware"><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1>VMware</span></a><a href="/tags/vSphere"><span class="badge tip" style="vertical-align:center;" data-v-0f5ba3f1>vSphere</span></a></div></div> <p>自從離開前一間實習的公司，我就缺乏一個可以做 Lab 的地方，深刻感受到「伺服器戒斷症」。想當初公司是天天有 Server 可以使用，有 Cisco UCS、Hyperflex 和 Supermicro 的等等，離開後變成只能偶爾用 AWS Educate 帳號開個限制滿滿的 EC2。這次學校電腦教室有汰換下來的幾台電腦，聽說當初買一台要價 10 萬元，不過也是好幾年前了。規格不會太差，因此開始動起<s>歪</s>腦筋，抱了一台到座位旁開始研究。</p> <p><img src="https://i.imgur.com/YZS8IRs.png" alt=""></p> <h2 id="規格"><a href="#規格" class="header-anchor">#</a> 規格</h2> <p>規格還不差：</p> <ol><li>CPU: Intel Xeon E5 2620</li> <li>MB: ASUS Z9PE-D8 WS 支援雙CPU、四通道、單科 CPU 支援到 64GB RAM、自帶兩個 1G 網路介面</li> <li>RAM: 原本很寒酸的差了一條 8GB (PC3-12800)，我打算怒擴到 32GB</li> <li>顯卡：NVIDIA GeForce GTX 780， 其實我裝 ESXi 根本不太需要顯卡</li> <li>SSD: 200GB</li> <li>HDD: 1TB</li> <li>噢易還原卡 (畢竟電腦教室的電腦，正常)</li></ol> <h2 id="前置作業"><a href="#前置作業" class="header-anchor">#</a> 前置作業</h2> <p>首先當然是拔掉還原卡，然後格式化硬碟，製作開機 USB 來安裝 ESXi。到 VMware 官網下載了 VMware vSphere Hypervisor 6.7 (ESXi)，接著使用 <a href="https://rufus.ie/" target="_blank" rel="noopener noreferrer">rufus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 做成開機片。 附帶一提，ESXi 是可以免費使用的，灌完記得去剛才的下載頁面，上面會有免費版序號，再從 ESXi web GUI 貼上即可，沒有期限，但不能搭配 vCenter。</p> <p>回想以前灌 ESXi 時，安裝過程會做格式化，所以我就懶的手動自己格式化一遍。</p> <div class="custom-block danger"><p class="custom-block-title">結果，</p> <p>這才是麻煩的開始。</p></div> <h2 id="踩雷"><a href="#踩雷" class="header-anchor">#</a> 踩雷</h2> <p>安裝 ESXi 時，看進度條看很爽，結果重開機後出現：</p> <p><img src="https://i.imgur.com/iCiHrIQ.png" alt=""></p> <p>這簡直被澆冷水！ Google 之後發現和 Windows 有關，<a href="https://communities.vmware.com/thread/429698" target="_blank" rel="noopener noreferrer">這個提問有人回答<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。由於這台電腦的硬碟是安裝 Win 10，而 Win 10 會複寫 <a href="https://zh.wikipedia.org/wiki/%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95" target="_blank" rel="noopener noreferrer">MBR<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>分割表，使其有數值而非為0，所以造成 ESXi 錯誤，如下圖。</p> <p><img src="https://communities.vmware.com/servlet/JiveServlet/showImage/2-2499870-50004/everpic-20150422_210158.367.png" alt=""></p> <p>好，所以這時候只得乖乖格式化硬碟了，而且經過查詢，格式化不見得會清除 MBR 的部分，為了保險起見，MBR 那 512 Bytes 最好全部變成&quot;0&quot;。但是作業系統已經被我弄掉了，要格式化除非拔下來，不然就是製作 Linux Live 的開機片，使用指令操作格式化。因為該硬碟看起來不好拔，我決定使用後者的方法。(幸好今天一口氣帶了3個隨身碟)</p> <h2 id="救星：gparted"><a href="#救星：gparted" class="header-anchor">#</a> 救星：GParted</h2> <p><a href="https://gparted.org/" target="_blank" rel="noopener noreferrer">GParted<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一個 partition editor，有圖形介面和 CLI，可以安裝到現有OS，也可以做成開機片 (正是我想要的！)。我到<a href="https://gparted.org/download.php" target="_blank" rel="noopener noreferrer">這裡<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下載 iso 映像檔，加上<a href="http://www.linuxliveusb.com/" target="_blank" rel="noopener noreferrer">LinuxLive USB Creator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，把 USB 做成開機片。從 BIOS 設定 USB 開機後出現畫面了。</p> <p><img src="https://i.imgur.com/MYhwsgp.png" alt=""></p> <p>第一次進到 GParted 選擇第一個選項就被雷了，馬上沒有畫面訊號。後來我選了第三個選項 <code>Other modes of GParted</code>。</p> <p><img src="https://i.imgur.com/JGuzlWQ.png" alt=""></p> <p>接著選擇 <code>GParted Live Safe graphics settings</code>，如果你發現你的電腦也不能開啟 GParted，請嘗試這個選項。</p> <p><img src="https://i.imgur.com/bdbjNxf.png" alt=""></p> <p>成功進入了，可以敲 command 了</p> <p><img src="https://i.imgur.com/NPbQOeD.png" alt=""></p> <p>首先列出所有硬碟：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ls</span> /dev/<span class="token punctuation">[</span>sh<span class="token punctuation">]</span>d*
/dev/sda  /dev/sdb <span class="token punctuation">..</span>.
</code></pre></div><p>接著猜猜看，我覺得目標是 <code>/dev/sda/</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">fdisk</span> -l /dev/sda
</code></pre></div><p><img src="https://i.imgur.com/P0b9guO.png" alt=""></p> <h3 id="處理mbr"><a href="#處理mbr" class="header-anchor">#</a> 處理MBR</h3> <p>看容量，果然是 <code>sda</code>，我先把他的 MBR 抹成 0。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>/dev/sda <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">512</span> <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">#然後再確認一次</span>
<span class="token function">fdisk</span> -l /dev/sda
</code></pre></div><p>你會發現 <code>GPT Table is corrupted</code> 的錯誤訊息消失了。</p> <p><img src="https://i.imgur.com/voXIWDy.png" alt=""></p> <h3 id="切磁區"><a href="#切磁區" class="header-anchor">#</a> 切磁區</h3> <p>我想用 <a href="https://zh.wikipedia.org/wiki/GUID%E7%A3%81%E7%A2%9F%E5%88%86%E5%89%B2%E8%A1%A8" target="_blank" rel="noopener noreferrer">GPT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，所以接著使用 <code>parted</code>工具進行磁區分割，這目的是為了讓 ESXi installer 更有可能認出這顆硬碟。所以我只切一個磁區，指定範圍從 1 到 240GB，它會自動掠過 MBR 和 GPT的部分，所以<code>START</code>可以放心打上&quot;1&quot;。</p> <p><img src="https://i.imgur.com/D10gxIy.png" alt=""></p> <p>也可以用下面這行指令代替：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">parted</span> /dev/sda mklabel gpt mkpart P1 fat32 <span class="token number">1</span> 240GB
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意：</p> <p>使用這些指令請格外小心！</p></div> <h3 id="格式化"><a href="#格式化" class="header-anchor">#</a> 格式化</h3> <p>接著使用 <code>mkfs</code> 格式化，保險起見使用 FAT32，不要用 ext2 或 ext3，文件有提到這可能會讓 ESXi 安裝失敗，至少我使用 FAT32 最後成功安裝了。VMware 會把硬碟格式化成 VMFS，但是安裝前也要注意格式，減少踩雷機率。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mkfs.vfat -F <span class="token number">32</span> /dev/sda1
</code></pre></div><p>重新安裝，成功。看到熟悉的黃灰畫面。</p> <p><img src="https://i.imgur.com/0LtDy0Z.png" alt=""></p> <p>折騰半天，終於成功在 LAB 擁有自己的 Server 了 <s>不用花自己的電費和硬體$$</s></p> <div id="disqus_thread"></div></div> <!----> </main> <footer><div>
      Copyright © 2019-present Li Yen Tseng, Powered by <a href="http://vuepress.vuejs.org">VuePress</a></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.76b48eb5.js" defer></script><script src="/assets/js/3.56656fbc.js" defer></script><script src="/assets/js/2.c4dd9767.js" defer></script><script src="/assets/js/4.bb04b1e8.js" defer></script><script src="/assets/js/13.808138b6.js" defer></script>
  </body>
</html>
